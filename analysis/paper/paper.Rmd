---
title: "Title Goes Here"
author:
  - Yichun Chen:
      email: yichun33@uw.edu
      institute: [UofO]
      correspondence: true
  - Ben Marwick:
      email: fl@another.edu
      institute: [UofA]
      correspondence: false
institute:
  - UofO: University of One Place
  - UofA: University of Another Place
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    bookdown::word_document2:
      fig_caption: yes
      reference_docx: "../templates/template.docx" # Insert path for the DOCX file
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua
bibliography: references.bib
csl: "../templates/journal-of-archaeological-science.csl" # Insert path for the bib-style
abstract: |
  Text of abstract
keywords: |
  keyword 1; keyword 2; keyword 3
highlights: |
  These are the highlights. 
---


<!-- This is the format for text comments that will be ignored during renderings. Do not put R code in these comments because it will not be ignored. -->

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.path = "../figures/",
  dpi = 300
)
```

# Introduction

Here is a citation [@Marwick2017]

Gender under-representation and inequality has long existed, from under-representation in childrenâ€™s picture books to academic publications (Hamilton et al. 2006; Tushingham et al. 2017). When talking about inequality in academic fields, we usually refer to the disproportionality between men and women in the field, including archaeology. Women are often underrepresented due to the lack of support women receive in academic fields (Xu 2008). When focusing on the field of archaeology, we can see that gender imbalance still occurs in archaeology and that seems to impact the kind of publications that are done in the field (Bardolph et al. 2016). As we can see in the authorship of the main authors from the Journal of Field Archaeology, 78% of them are men (Heath-Stout 2020). When looking at gender ratios among the membership in Society for California Archaeology from 1967 to 2016, Tushingham et al. (2017) report a trend of women increasingly maintaining their society membership and the gender gap is almost gone. In this study we investigate gender ratios of presenters at major archaeological conferences. We extend the work of Tushingham et al. (2017) with a study of gender ratios of presenters at meetings of the Society of American Archaeology (SAA, 2016-2019), the European Association of Archaeologists (EAA, 2018) and the Computer Applications and Quantitative Methods in Archaeology (CAA, 2017)  We explore how gender ratios vary over time and between these conferences. We examine the influence of the gender of the presenter on the topics that they present on.

# Background



```{r}
# CTRL + OPTION + i to insert a code block
library(here)
# column names should be:
# session, FirstName, AbstractTitle

SAA18 <- readxl::read_excel(here("analysis/data/raw-data/2018 SAA Title.xlsx"))
EAA18 <- readxl::read_excel(here("analysis/data/raw-data/2018 EAA.xlsx"))
CAA18 <- readxl::read_excel(here("analysis/data/raw-data/2018 CAA.xlsx"))

SAA18_row <- nrow(SAA18)      
EAA18_row <- nrow(EAA18)      
CAA18_row <- nrow(CAA18)      

```

# Methods

We collected lists of the people that presented research at recent SAA (2018 with `r SAA18_row` presenters, EAA (2018 with `r EAA18_row` presenters) and CAA (2018 with `r CAA18_row` presenters) conferences. We obtained publicly available programs of these conferences and also tidied the data into a rectangular form with variables including the primary author's first name, last name and the title of their presentation. We used R and the gender package (Mullen 2018; Mihaljevic 2019; Belvis et al. 2015) to predict the gender of all first-named presenters in our sample. We used the gender package to identify a first name as male or female, based on a probability scale computed from government records of name-gender data, specifically US Social Security Administration (SSA) baby name data (Mullen 2019). This method has the advantage of speed and ease of automation, but also some substantial limitations. We are only able to infer gender into binary male/female genders and assign probabilities for the first names into these categories. This has the unfortunate result of excluding other genders from the results, and we encourage conference organizers to collect gender data directly from participants to improve the representation of minority genders in future studies. The package often fails to classify non-English names, as the SSA data the package uses are mostly in English names. This means that people with non-English names are underrepresented in our results. To remove names where gender is ambiguous, which we define as a similar proportion of males and females having that name in the SSA data, we excluded names where the difference in proportions was less than 0.47, a figure we obtained by exploratory data analysis. It is important to note that the gender designations here are not self-identified by the presenters, but are computed probabilistically. Better quality data will come if presenters self-identify their gender, but we have no alternative because currently these data are not available. Our hope is that this work, despite its many limitations, will stimulate the collection of more reliable, justifiable, and useful data by conference organisers. 

We are also interested in whether there is a variation in topic choices between these two genders in archaeological conferences. To do this we have used topic modeling, which is a method to automatically find related groups of words that resemble 'themes' or 'topics'. This approach does not treat one topic, which consists of many words, as separate from another topic. That is, a word can be present in many topics but with differs weightings. When generating topic models, we have to first decide on the number of topics that the method will identify in our texts. We then create a topic model for all our texts, this will assign all words in every document into our set number of topics, and assign each word a probability based on its per-topic-per-word probability. To visualise the topic model we use the top 10 words within each topic as keywords to represent each topic. We excluded words that are common in the field of archaeology or have little semantic value, for example, 'the', 'a', 'el', 'al', 'archaeology', etc. We generated one topic model per conference. Each presentation at each conference is then assigned a vector of topic probabilities. 

We then tried another process of topic modeling called Structural Topic Model (STM) which is very similar to the LDA we have described above. The main advantage for us is that, the STM allows us to include, alongside the normal topic modeling process, other metadata. This process "attaches" the metadata to the collection of texts that we will then perform topic modeling process. It is important to note that we have used the stm package that also includes the ability to calculate the number of topics that is best suited for STM modeling (Roberts 2019). The fact that we are allowed to do this allows us to perform covariate analysis (Roberts et al. 2013). This basically means that we can examine the relationship between the topics and some covariates/variables of interest. We can define the genders of males and females and then analyze the prevelance of these two categories in accordance with the topics that the stm package determined (Roberts 2019). The analysis is used also with probabilities given to the texts to see if the most occuring of some text seems to be "attached" to one gender over another.

To explore the relationship between gender and topics we identified the most prominent topic for each presentation... 

# Results
```{r}
number_of_papers_saa_2018 <-  ...
```


- some basic details ( 1 para)
-- number of papers that are in our sample for each conference
-- number of men and women first-named presented, state the gender ratio 
-- number of people that we could not assign a gender to

The number of ... `r number_of_papers_saa_2018` ... 

- the main details
-- number of topics that are optimum for each conf (1 para)
-- variance of topics with gender for each conf (1 para)


```{r}
# make the custom functions available here in this Rmd file
source(here::here("analysis/paper/functions-for-gender.R"))
source(here::here("analysis/paper/functions-for-topic-models.R"))
```


```{r}
# let's run the topic model fn for each conf
CAA18_tm <- do_the_topic_model(CAA18, 21)
EAA18_tm <- do_the_topic_model(EAA18, 12)
SAA18_tm <- do_the_topic_model(SAA18, 21)

# Let's save the output for each one
saveRDS(CAA18_tm, here::here("analysis/data/derived-data/CAA18_topic_model.rds"))
saveRDS(EAA18_tm, here::here("analysis/data/derived-data/EAA18_topic_model.rds"))
saveRDS(SAA18_tm, here::here("analysis/data/derived-data/SAA18_topic_model.rds"))

# gender model
CAA18_gm <- get_the_gender_data(CAA18)
saveRDS(CAA18_gm, here::here("analysis/data/derived-data/CAA18_gender_model.rds"))
SAA18_gm <- get_the_gender_data(SAA18)
saveRDS(SAA18_gm, here::here("analysis/data/derived-data/SAA18_gender_model.rds"))
```


Figure \@ref(fig:demo-plot) shows how we can have a caption and cross-reference for a plot

```{r demo-inline-code}
x <- round(pi, 2)
```

Here is an example of inline code `r x` in the middle of a sentence. 

# Discussion

# Conclusion

# Acknowledgements

<!-- The following line inserts a page break  -->
\newpage

# References 
<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->
<div id="refs"></div>

\newpage

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies: 

```{r colophon, cache = FALSE}
# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()
```

The current Git commit details are:
u
```{r}
# what commit is this file at? 
if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())  
```
